{"version":3,"file":"logger.js","sources":["../../src/logger.ts"],"sourcesContent":["import ansis from 'ansis'\nimport { diffWords } from 'diff'\n\nexport function logDiff(oldStr: string, newStr: string) {\n  const differences = diffWords(oldStr, newStr)\n\n  let output = ''\n  let unchangedLines = ''\n\n  function processUnchangedLines(lines: string): string {\n    const lineArray = lines.split('\\n')\n    if (lineArray.length > 4) {\n      return [\n        ansis.dim(lineArray[0]),\n        ansis.dim(lineArray[1]),\n        '',\n        ansis.dim.bold(`... (${lineArray.length - 4} lines) ...`),\n        '',\n        ansis.dim(lineArray[lineArray.length - 2]),\n        ansis.dim(lineArray[lineArray.length - 1]),\n      ].join('\\n')\n    }\n    return ansis.dim(lines)\n  }\n\n  differences.forEach((part, index) => {\n    const nextPart = differences[index + 1]\n\n    if (part.added) {\n      if (unchangedLines) {\n        output += processUnchangedLines(unchangedLines)\n        unchangedLines = ''\n      }\n      output += ansis.green.bold(part.value)\n      if (nextPart?.removed) output += ' '\n    } else if (part.removed) {\n      if (unchangedLines) {\n        output += processUnchangedLines(unchangedLines)\n        unchangedLines = ''\n      }\n      output += ansis.red.bold(part.value)\n      if (nextPart?.added) output += ' '\n    } else {\n      unchangedLines += part.value\n    }\n  })\n\n  // Process any remaining unchanged lines at the end\n  if (unchangedLines) {\n    output += processUnchangedLines(unchangedLines)\n  }\n\n  if (output) {\n    console.log('\\nDiff:')\n    console.log(output + '\\n\\n')\n  } else {\n    console.log('No changes')\n  }\n}\n"],"names":[],"mappings":";;AAGO,SAAS,QAAQ,QAAgB,QAAgB;AACtD,QAAM,cAAc,UAAU,QAAQ,MAAM;AAE5C,MAAI,SAAS;AACb,MAAI,iBAAiB;AAErB,WAAS,sBAAsB,OAAuB;AACpD,UAAM,YAAY,MAAM,MAAM,IAAI;AAClC,QAAI,UAAU,SAAS,GAAG;AACxB,aAAO;AAAA,QACL,MAAM,IAAI,UAAU,CAAC,CAAC;AAAA,QACtB,MAAM,IAAI,UAAU,CAAC,CAAC;AAAA,QACtB;AAAA,QACA,MAAM,IAAI,KAAK,QAAQ,UAAU,SAAS,CAAC,aAAa;AAAA,QACxD;AAAA,QACA,MAAM,IAAI,UAAU,UAAU,SAAS,CAAC,CAAC;AAAA,QACzC,MAAM,IAAI,UAAU,UAAU,SAAS,CAAC,CAAC;AAAA,MAAA,EACzC,KAAK,IAAI;AAAA,IACb;AACA,WAAO,MAAM,IAAI,KAAK;AAAA,EACxB;AAEA,cAAY,QAAQ,CAAC,MAAM,UAAU;AACnC,UAAM,WAAW,YAAY,QAAQ,CAAC;AAEtC,QAAI,KAAK,OAAO;AACd,UAAI,gBAAgB;AAClB,kBAAU,sBAAsB,cAAc;AAC9C,yBAAiB;AAAA,MACnB;AACA,gBAAU,MAAM,MAAM,KAAK,KAAK,KAAK;AACrC,UAAI,UAAU,QAAS,WAAU;AAAA,IACnC,WAAW,KAAK,SAAS;AACvB,UAAI,gBAAgB;AAClB,kBAAU,sBAAsB,cAAc;AAC9C,yBAAiB;AAAA,MACnB;AACA,gBAAU,MAAM,IAAI,KAAK,KAAK,KAAK;AACnC,UAAI,UAAU,MAAO,WAAU;AAAA,IACjC,OAAO;AACL,wBAAkB,KAAK;AAAA,IACzB;AAAA,EACF,CAAC;AAGD,MAAI,gBAAgB;AAClB,cAAU,sBAAsB,cAAc;AAAA,EAChD;AAEA,MAAI,QAAQ;AACV,YAAQ,IAAI,SAAS;AACrB,YAAQ,IAAI,SAAS,MAAM;AAAA,EAC7B,OAAO;AACL,YAAQ,IAAI,YAAY;AAAA,EAC1B;AACF;"}